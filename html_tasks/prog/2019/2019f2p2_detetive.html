title:Detetive
template:tasks/tarefa_programacao.html

<p>
Uma agência de detetives quer criar um aplicativo para ajudar a
resolver os problemas dos clientes.

<p>
A agência é muito eficiente em coletar informações e fazer deduções
muito precisas.  Para cada cliente a agência monta uma base de dados
contendo um conjunto de <it>eventos</it> e um conjunto
de <it>implicações</it> na forma A &rarr; B, onde A e B representam
eventos. O significado da implicação é que, se o evento A ocorreu,
então o evento B também necessariamente tem que ter ocorrido. Para
essa implicação, A é a causa e B é a consequência. Além disso, se um
evento é consequência de pelo menos uma causa, então ele só pode
ocorrer se pelo menos uma de suas causas ocorrer também. Não existe,
na base de dados da agência, uma sequência circular de implicações (A
&rarr; B &rarr; C ... &rarr; A). Portanto, alguns eventos não
possuem causa, não são consequência em nenhuma implicação.

<p>
Veja que essas condições permitem deduções muito precisas. Por
exemplo, considere que o conjunto de eventos seja {1,2,3,4} e o
conjunto de implicações seja {1 &rarr;  2, 1 &rarr;  3,
2 &rarr;  4, 3 &rarr;  4}. Se algum detetive conseguir
determinar que o evento 4 é verdadeiro, que ele ocorreu, então o
evento 2 ou o evento 3 tem que ter ocorrido, mas para eles
ocorrerem o evento sem causa 1 tem que ter ocorrido. E como 1
ocorreu, por implicação, 2 e 3 ocorreram também. Portanto o
aplicativo da agência poderia concluir que todos os quatro eventos
ocorreram com certeza, a partir da determinação de que o evento 4
ocorreu. Por um outro exemplo, considere que o conjunto de eventos
seja {1,2,3} e o conjunto de implicações seja {1 &rarr;  3,
2 &rarr;  3}. Se um detetive determinar que o evento 3 é
verdadeiro, não podemos ter certeza de qual foi a causa.

<p>
A agência solicita que você escreva um programa para determinar o
conjunto de todos os eventos que ocorreram com certeza, considerando
as informações da base de dados e um conjunto inicial de eventos
determinados como verdadeiros pelos detetives.

<h3>Entrada</h3>
A primeira linha contém três números inteiros
E, I e V, representando respectivamente o número
total de eventos, o número de implicações e o número de eventos
que a agência determinou que são verdadeiros.

<p>
Cada evento é identificado por um número de 1 a E.
Cada uma das I linhas seguintes contém dois inteiros A e B,
representando dois eventos,
descrevendo uma implicação A  &rarr;  B coletada pela
agência. A última linha contém V inteiros X<sub>i</sub>, representando
os eventos que a agência determinou que são verdadeiros. Os eventos
X<sub>i</sub> são dados em ordem crescente do número de identificação.


<h3>Saída</h3>
Seu programa deve produzir uma única linha,
com os identificadores de todos os eventos que certamente ocorreram,
considerando o conjunto de implicações
dado na entrada. Os identificadores dos eventos devem ser
escritos em ordem crescente, separados por um único espaço em branco.

<h3>Restrições</h3>
<ul>
<li> 1  &leq;  E  &leq;  10<sup>3</sup>
<li> 1  &leq;  I  &leq;  10<sup>5</sup>
<li> 1  &leq;  A, B, V  &leq;  E
<li> 1  &leq;  X<sub>i</sub>  &leq;  E, para 1  &leq;  i  &leq;  V.
</ul>

<h3>Informações sobre a pontuação</h3>
<ul>
<li> Para um conjunto de casos de testes valendo 70 pontos, 1  &leq;  E  &leq;  500.
</ul>


<h3>Exemplos</h3>
<table width="100%" cellspace="2" border="1">
  <tr>
    <td valign="top" width="50%">
      <b>Entrada</b>
      <pre>
3 2 1
2 3
1 2
3
</pre>
      </td>
    <td valign="top" width="50%">
      <b>Saída</b>
      <pre>
1 2 3
	</pre>
      </td>
    </tr>
</table>

<p>&nbsp;</p>

<table width="100%" cellspace="2" border="1">
  <tr>
    <td valign="top" width="50%">
      <b>Entrada</b>
      <pre>
4 4 1
1 2
1 3
2 4
3 4
4
</pre>
      </td>
    <td valign="top" width="50%">
      <b>Saída</b>
      <pre>
1 2 3 4
	</pre>
      </td>
    </tr>
</table>

<p>&nbsp;</p>

<table width="100%" cellspace="2" border="1">
  <tr>
    <td valign="top" width="50%">
      <b>Entrada</b>
      <pre>
3 2 1
1 3
2 3
3
</pre>
      </td>
    <td valign="top" width="50%">
      <b>Saída</b>
      <pre>
3
	</pre>
      </td>
    </tr>
</table>

<p>&nbsp;</p>

