title:Candidatas
template:exams/tarefa_programacao.html
order:2
<p>
Carla é uma biotecnóloga que está investigando proteínas para usar em
uma vacina. As proteínas estão codificadas em uma longa sequência de
números naturais, que vamos chamar de S.

<p>Através de múltiplos experimentos, Carla determinou que uma
subsequência contígua de S é <i>candidata</i> se o máximo divisor comum dos
elementos da subsequência é maior do que 1.

<p>Carla quer investigar o número de subsequências candidatas contidas em
alguns intervalos contíguos de S, possivelmente também alterando
alguns elementos de S. Mais precisamente, durante suas pesquisas ela
deseja realizar operações de dois tipos:

<ol>
<li> alterar o valor de um elemento da sequência S; e
<li> consultar o número de subsequências candidatas em um dado trecho
contíguo de S.
</ol>

Ajude Carla a realizar suas pesquisas e avançar na busca pela vacina!

<h3>Entrada</h3>
A primeira linha da entrada contém dois inteiros N e M, indicando
respectivamente o número de elementos na sequência S e o número de
operações a serem realizadas.  A segunda linha contém N inteiros
S<sub>i</sub>, os elementos da sequência S.  Os elementos são identificados
por índices de 1 a N.  Cada uma das M linhas seguintes descreve
uma operação e contém três inteiros.  O primeiro inteiro, T, indica
o tipo de operação e pode ser 1 ou 2. Se a operação é do tipo 1, os
dois números seguintes na linha são I e V, indicando que o
elemento de índice I da sequência S deve ter o valor atualizado para
V. Se a operação é do tipo 2, os dois números seguintes na linha são
E e D, indicando respectivamente o índice do elemento inicial e o
índice do elemento final de um intervalo contíguo da sequência S.


<h3>Saída</h3>
Para cada operação do tipo 2, seu programa deve produzir uma única linha, contendo
um único inteiro, o número de subsequências candidatas no intervalo indicado.

<h3>Restrições</h3>
<ul>
<li> 1  &leq;  N  &leq;  10<sup>5</sup>
<li> 1  &leq;  M  &leq;  10<sup>5</sup>
<li> 1  &leq;  S<sub>i</sub>  &leq;  10<sup>9</sup>, para 1  &leq;  i  &leq;  N
<li> 1  &leq;  I  &leq;  N
<li> 1  &leq;  V  &leq;  10<sup>9</sup>
<li> 1  &leq;  E  &leq;  D  &leq;  N
</ul>


<h3>Exemplos</h3>
<table width="100%" cellspace="2" border="1">
  <tr>
    <td valign="top" width="50%">
      <b>Entrada</b>
      <pre>
5 1
9 3 4 8 1
2 2 5
</pre>
      </td>
    <td valign="top" width="50%">
      <b>Saída</b>
      <pre>
4
	</pre>
      </td>
    </tr>
</table>

<p>&nbsp;</p>

<table width="100%" cellspace="2" border="1">
  <tr>
    <td valign="top" width="50%">
      <b>Entrada</b>
      <pre>
4 3
4 4 4 4
2 1 4
1 3 5
2 1 4
</pre>
      </td>
    <td valign="top" width="50%">
      <b>Saída</b>
      <pre>
10
5
	</pre>
      </td>
    </tr>
</table>

<p>&nbsp;</p>

<table width="100%" cellspace="2" border="1">
  <tr>
    <td valign="top" width="50%">
      <b>Entrada</b>
      <pre>
5 3
2 3 6 4 1
2 1 4
1 3 1
2 3 5
</pre>
      </td>
    <td valign="top" width="50%">
      <b>Saída</b>
      <pre>
6
1
	</pre>
      </td>
    </tr>
</table>

<p>&nbsp;</p>

