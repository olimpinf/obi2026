select 'IJ', (select count(*) from compet where compet_type=7 and compet_classif_fase2), 100*(select count(*) from compet where compet_type=7 and compet_classif_fase2)/(select count(*) from compet where compet_type=7 and compet_points_fase2 is not null);
select 'I1', (select count(*) from compet where compet_type=1 and compet_classif_fase2), 100*(select count(*) from compet where compet_type=1 and compet_classif_fase2)/(select count(*) from compet where compet_type=1 and compet_points_fase2 is not null);
select 'I2', (select count(*) from compet where compet_type=2 and compet_classif_fase2), 100*(select count(*) from compet where compet_type=2 and compet_classif_fase2)/(select count(*) from compet where compet_type=2 and compet_points_fase2 is not null);
select 'PJ', (select count(*) from compet where compet_type=5 and compet_classif_fase2), 100*(select count(*) from compet where compet_type=5 and compet_classif_fase2)/(select count(*) from compet as c,points_fase2 as p where c.compet_id=p.compet_id and compet_type=5 and (p.points_a is not null or p.points_b is not null));
select 'P1', (select count(*) from compet where compet_type=3 and compet_classif_fase2), 100*(select count(*) from compet where compet_type=3 and compet_classif_fase2)/(select count(*) from compet as c,points_fase2 as p where c.compet_id=p.compet_id and compet_type=3 and (p.points_a is not null or p.points_b is not null));
select 'P2', (select count(*) from compet where compet_type=4 and compet_classif_fase2), 100*(select count(*) from compet where compet_type=4 and compet_classif_fase2)/(select count(*) from compet as c,points_fase2 as p where c.compet_id=p.compet_id and compet_type=4 and (p.points_a is not null or p.points_b is not null));
select 'PS', (select count(*) from compet where compet_type=6 and compet_classif_fase2) 100*(select count(*) from compet where compet_type=6 and compet_classif_fase2)/(select count(*) from compet as c,points_fase2 as p where c.compet_id=p.compet_id and compet_type=6 and (p.points_a is not null or p.points_b is not null));
